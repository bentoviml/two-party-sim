This is a work in progress. More detail to come. See notebooks/test.ipynb for work in progress simulations
